{"timestamp":"2025-07-15T03:49:00.550025","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-07-15T03:49:00.551454","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/activefence.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-07-15T03:49:14.265380Z","level":"error","event":"/home/airflow/.local/lib/python3.12/site-packages/pyspark/bin/load-spark-env.sh: line 68: ps: command not found","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-15T03:49:16.808027Z","level":"info","event":":: loading settings :: url = jar:file:/home/airflow/.local/lib/python3.12/site-packages/pyspark/jars/ivy-2.5.1.jar!/org/apache/ivy/core/settings/ivysettings.xml","chan":"stdout","logger":"task"}
{"timestamp":"2025-07-15T03:49:16.915768Z","level":"error","event":"Ivy Default Cache set to: /home/airflow/.ivy2/cache","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-15T03:49:16.916482Z","level":"error","event":"The jars for the packages stored in: /home/airflow/.ivy2/jars","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-15T03:49:16.921543Z","level":"error","event":"org.apache.hadoop#hadoop-aws added as a dependency","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-15T03:49:16.922375Z","level":"error","event":"com.amazonaws#aws-java-sdk-bundle added as a dependency","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-15T03:49:16.923179Z","level":"error","event":"org.apache.spark#spark-avro_2.12 added as a dependency","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-15T03:49:16.923882Z","level":"error","event":"io.delta#delta-spark_2.12 added as a dependency","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-15T03:49:16.924528Z","level":"error","event":":: resolving dependencies :: org.apache.spark#spark-submit-parent-2e30be06-a2e7-48a8-bfed-42fba713a064;1.0","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-15T03:49:16.925129Z","level":"error","event":"\tconfs: [default]","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-15T03:49:17.139078Z","level":"error","event":"\tfound org.apache.hadoop#hadoop-aws;3.3.4 in central","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-15T03:49:17.185313Z","level":"error","event":"\tfound org.wildfly.openssl#wildfly-openssl;1.0.7.Final in central","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-15T03:49:17.202317Z","level":"error","event":"\tfound com.amazonaws#aws-java-sdk-bundle;1.12.520 in central","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-15T03:49:17.244479Z","level":"error","event":"\tfound org.apache.spark#spark-avro_2.12;3.5.0 in central","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-15T03:49:17.266177Z","level":"error","event":"\tfound org.tukaani#xz;1.9 in central","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-15T03:49:17.292452Z","level":"error","event":"\tfound io.delta#delta-spark_2.12;3.1.0 in central","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-15T03:49:17.314062Z","level":"error","event":"\tfound io.delta#delta-storage;3.1.0 in central","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-15T03:49:17.332038Z","level":"error","event":"\tfound org.antlr#antlr4-runtime;4.9.3 in central","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-15T03:49:17.376635Z","level":"error","event":":: resolution report :: resolve 429ms :: artifacts dl 25ms","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-15T03:49:17.377912Z","level":"error","event":"\t:: modules in use:","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-15T03:49:17.378969Z","level":"error","event":"\tcom.amazonaws#aws-java-sdk-bundle;1.12.520 from central in [default]","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-15T03:49:17.379857Z","level":"error","event":"\tio.delta#delta-spark_2.12;3.1.0 from central in [default]","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-15T03:49:17.380330Z","level":"error","event":"\tio.delta#delta-storage;3.1.0 from central in [default]","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-15T03:49:17.380893Z","level":"error","event":"\torg.antlr#antlr4-runtime;4.9.3 from central in [default]","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-15T03:49:17.381283Z","level":"error","event":"\torg.apache.hadoop#hadoop-aws;3.3.4 from central in [default]","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-15T03:49:17.381579Z","level":"error","event":"\torg.apache.spark#spark-avro_2.12;3.5.0 from central in [default]","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-15T03:49:17.381900Z","level":"error","event":"\torg.tukaani#xz;1.9 from central in [default]","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-15T03:49:17.382247Z","level":"error","event":"\torg.wildfly.openssl#wildfly-openssl;1.0.7.Final from central in [default]","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-15T03:49:17.382847Z","level":"error","event":"\t:: evicted modules:","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-15T03:49:17.383357Z","level":"error","event":"\tcom.amazonaws#aws-java-sdk-bundle;1.12.262 by [com.amazonaws#aws-java-sdk-bundle;1.12.520] in [default]","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-15T03:49:17.383775Z","level":"error","event":"\t---------------------------------------------------------------------","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-15T03:49:17.384212Z","level":"error","event":"\t|                  |            modules            ||   artifacts   |","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-15T03:49:17.384746Z","level":"error","event":"\t|       conf       | number| search|dwnlded|evicted|| number|dwnlded|","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-15T03:49:17.385243Z","level":"error","event":"\t---------------------------------------------------------------------","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-15T03:49:17.385746Z","level":"error","event":"\t|      default     |   9   |   0   |   0   |   1   ||   8   |   0   |","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-15T03:49:17.386185Z","level":"error","event":"\t---------------------------------------------------------------------","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-15T03:49:17.389573Z","level":"error","event":":: retrieving :: org.apache.spark#spark-submit-parent-2e30be06-a2e7-48a8-bfed-42fba713a064","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-15T03:49:17.390120Z","level":"error","event":"\tconfs: [default]","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-15T03:49:17.400459Z","level":"error","event":"\t0 artifacts copied, 8 already retrieved (0kB/11ms)","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-15T03:49:17.700649Z","level":"error","event":"25/07/15 03:49:17 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-15T03:49:18.028713Z","level":"error","event":"Setting default log level to \"WARN\".","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-15T03:49:18.029596Z","level":"error","event":"To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-15T03:49:21.505235","level":"info","event":"Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.","logger":"chromadb.telemetry.product.posthog"}
{"timestamp":"2025-07-15T03:49:24.268046Z","level":"error","event":"25/07/15 03:49:24 WARN MetricsConfig: Cannot locate configuration: tried hadoop-metrics2-s3a-file-system.properties,hadoop-metrics2.properties","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-15T03:49:37.902843Z","level":"error","event":"\r[Stage 0:>                                                          (0 + 2) / 2]\r\r                                                                                \r25/07/15 03:49:37 WARN SparkStringUtils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.sql.debug.maxToStringFields'.","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-15T03:50:30.228111","level":"error","event":"Error processing Delta table: HTTPConnectionPool(host='ollama', port=11434): Max retries exceeded with url: /api/embed (Caused by NameResolutionError(\"<urllib3.connection.HTTPConnection object at 0x7fab6771a0c0>: Failed to resolve 'ollama' ([Errno -3] Temporary failure in name resolution)\"))","logger":"unusual_prefix_0aab8e1abe4a8f324d874f9a30de87ad63865522_activefence"}
{"timestamp":"2025-07-15T03:50:30.840791","level":"error","event":"Failed to connect to ChromaDB: {\"detail\":\"Not Found\"}","logger":"unusual_prefix_0aab8e1abe4a8f324d874f9a30de87ad63865522_activefence"}
{"timestamp":"2025-07-15T03:50:30.841978","level":"error","event":"Task failed with exception","logger":"task","error_detail":[{"exc_type":"ValueError","exc_value":"{\"detail\":\"Not Found\"}","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":867,"name":"run"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1159,"name":"_execute_task"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/operator.py","lineno":397,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":216,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":239,"name":"execute_callable"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/callback_runner.py","lineno":81,"name":"run"},{"filename":"/opt/airflow/dags/activefence.py","lineno":334,"name":"embed_gold_data"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/chromadb/__init__.py","lineno":244,"name":"HttpClient"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/chromadb/api/client.py","lineno":72,"name":"__init__"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/chromadb/api/client.py","lineno":117,"name":"get_user_identity"}],"is_group":false,"exceptions":[]},{"exc_type":"Exception","exc_value":"{\"detail\":\"Not Found\"}","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/chromadb/api/client.py","lineno":108,"name":"get_user_identity"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/chromadb/telemetry/opentelemetry/__init__.py","lineno":150,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/chromadb/api/fastapi.py","lineno":202,"name":"get_user_identity"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/chromadb/api/fastapi.py","lineno":108,"name":"_make_request"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/chromadb/api/base_http_client.py","lineno":105,"name":"_raise_chroma_error"}],"is_group":false,"exceptions":[]},{"exc_type":"HTTPStatusError","exc_value":"Client error '404 Not Found' for url 'http://chroma:8000/api/v2/auth/identity'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/chromadb/api/base_http_client.py","lineno":100,"name":"_raise_chroma_error"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/httpx/_models.py","lineno":761,"name":"raise_for_status"}],"is_group":false,"exceptions":[]},{"exc_type":"ConnectionError","exc_value":"HTTPConnectionPool(host='ollama', port=11434): Max retries exceeded with url: /api/embed (Caused by NameResolutionError(\"<urllib3.connection.HTTPConnection object at 0x7fab6771a0c0>: Failed to resolve 'ollama' ([Errno -3] Temporary failure in name resolution)\"))","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/opt/airflow/dags/activefence.py","lineno":300,"name":"embed_gold_data"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/requests/api.py","lineno":115,"name":"post"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/requests/api.py","lineno":59,"name":"request"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/requests/sessions.py","lineno":589,"name":"request"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/requests/sessions.py","lineno":703,"name":"send"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/requests/adapters.py","lineno":700,"name":"send"}],"is_group":false,"exceptions":[]},{"exc_type":"MaxRetryError","exc_value":"HTTPConnectionPool(host='ollama', port=11434): Max retries exceeded with url: /api/embed (Caused by NameResolutionError(\"<urllib3.connection.HTTPConnection object at 0x7fab6771a0c0>: Failed to resolve 'ollama' ([Errno -3] Temporary failure in name resolution)\"))","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/requests/adapters.py","lineno":667,"name":"send"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/urllib3/connectionpool.py","lineno":841,"name":"urlopen"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/urllib3/util/retry.py","lineno":519,"name":"increment"}],"is_group":false,"exceptions":[]},{"exc_type":"NameResolutionError","exc_value":"<urllib3.connection.HTTPConnection object at 0x7fab6771a0c0>: Failed to resolve 'ollama' ([Errno -3] Temporary failure in name resolution)","exc_notes":[],"syntax_error":null,"is_cause":true,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/urllib3/connectionpool.py","lineno":787,"name":"urlopen"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/urllib3/connectionpool.py","lineno":493,"name":"_make_request"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/urllib3/connection.py","lineno":445,"name":"request"},{"filename":"/usr/local/lib/python3.12/http/client.py","lineno":1333,"name":"endheaders"},{"filename":"/usr/local/lib/python3.12/http/client.py","lineno":1093,"name":"_send_output"},{"filename":"/usr/local/lib/python3.12/http/client.py","lineno":1037,"name":"send"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/urllib3/connection.py","lineno":276,"name":"connect"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/urllib3/connection.py","lineno":205,"name":"_new_conn"}],"is_group":false,"exceptions":[]},{"exc_type":"gaierror","exc_value":"[Errno -3] Temporary failure in name resolution","exc_notes":[],"syntax_error":null,"is_cause":true,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/urllib3/connection.py","lineno":198,"name":"_new_conn"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/urllib3/util/connection.py","lineno":60,"name":"create_connection"},{"filename":"/usr/local/lib/python3.12/socket.py","lineno":978,"name":"getaddrinfo"}],"is_group":false,"exceptions":[]}]}
{"timestamp":"2025-07-15T03:50:31.855206Z","level":"error","event":"\r[Stage 1:>                                                          (0 + 2) / 2]\r\r[Stage 3:>                                                         (0 + 2) / 50]\r\r[Stage 3:==>                                                       (2 + 2) / 50]\r\r[Stage 3:=====>                                                    (5 + 2) / 50]\r\r[Stage 3:========>                                                 (7 + 2) / 50]\r\r[Stage 3:=========>                                                (8 + 2) / 50]\r\r[Stage 3:============>                                            (11 + 2) / 50]\r\r[Stage 3:==============>                                          (13 + 2) / 50]\r\r[Stage 3:==================>                                      (16 + 2) / 50]\r\r[Stage 3:=====================>                                   (19 + 2) / 50]\r\r[Stage 3:==========================>                              (23 + 2) / 50]\r\r[Stage 3:=============================>                           (26 + 2) / 50]\r\r[Stage 3:===================================>                     (31 + 2) / 50]\r\r[Stage 3:======================================>                  (34 + 2) / 50]\r\r[Stage 3:==========================================>              (37 + 3) / 50]\r\r[Stage 3:=================================================>       (43 + 2) / 50]\r\r[Stage 3:=====================================================>   (47 + 2) / 50]\r\r                                                                                \r\r[Stage 5:>                                                         (0 + 2) / 50]\r\r[Stage 5:======>                                                   (6 + 2) / 50]\r\r[Stage 5:==================>                                      (16 + 2) / 50]\r\r[Stage 5:==============================>                          (27 + 3) / 50]\r\r[Stage 5:===========================================>             (38 + 2) / 50]\r\r                                                                                \r\r[Stage 9:>                                                          (0 + 1) / 1]\r\r                                                                                \r\r[Stage 11:===============================================>        (42 + 2) / 50]","chan":"stderr","logger":"task"}
