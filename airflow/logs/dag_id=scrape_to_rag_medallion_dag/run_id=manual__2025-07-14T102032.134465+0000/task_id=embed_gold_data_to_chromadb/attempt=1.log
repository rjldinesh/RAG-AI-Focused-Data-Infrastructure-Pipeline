{"timestamp":"2025-07-14T10:20:37.847668","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-07-14T10:20:37.852457","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/activefence.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-07-14T10:20:50.572946Z","level":"error","event":"/home/airflow/.local/lib/python3.12/site-packages/pyspark/bin/load-spark-env.sh: line 68: ps: command not found","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-14T10:20:52.541920Z","level":"info","event":":: loading settings :: url = jar:file:/home/airflow/.local/lib/python3.12/site-packages/pyspark/jars/ivy-2.5.1.jar!/org/apache/ivy/core/settings/ivysettings.xml","chan":"stdout","logger":"task"}
{"timestamp":"2025-07-14T10:20:52.653263Z","level":"error","event":"Ivy Default Cache set to: /home/airflow/.ivy2/cache","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-14T10:20:52.654265Z","level":"error","event":"The jars for the packages stored in: /home/airflow/.ivy2/jars","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-14T10:20:52.661614Z","level":"error","event":"org.apache.hadoop#hadoop-aws added as a dependency","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-14T10:20:52.662310Z","level":"error","event":"com.amazonaws#aws-java-sdk-bundle added as a dependency","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-14T10:20:52.662719Z","level":"error","event":"org.apache.spark#spark-avro_2.12 added as a dependency","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-14T10:20:52.663031Z","level":"error","event":"io.delta#delta-spark_2.12 added as a dependency","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-14T10:20:52.663553Z","level":"error","event":":: resolving dependencies :: org.apache.spark#spark-submit-parent-575a89f9-c888-4a84-8daf-d68de1b9bbfd;1.0","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-14T10:20:52.664084Z","level":"error","event":"\tconfs: [default]","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-14T10:20:57.734026Z","level":"error","event":"\tfound org.apache.hadoop#hadoop-aws;3.3.4 in central","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-14T10:21:01.047162Z","level":"error","event":"\tfound org.wildfly.openssl#wildfly-openssl;1.0.7.Final in central","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-14T10:21:02.980893Z","level":"error","event":"\tfound com.amazonaws#aws-java-sdk-bundle;1.12.520 in central","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-14T10:21:06.543477Z","level":"error","event":"\tfound org.apache.spark#spark-avro_2.12;3.5.0 in central","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-14T10:21:07.010955Z","level":"error","event":"\tfound org.tukaani#xz;1.9 in central","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-14T10:21:07.407733Z","level":"error","event":"\tfound io.delta#delta-spark_2.12;3.1.0 in central","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-14T10:21:07.794103Z","level":"error","event":"\tfound io.delta#delta-storage;3.1.0 in central","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-14T10:21:10.296970Z","level":"error","event":"\tfound org.antlr#antlr4-runtime;4.9.3 in central","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-14T10:21:11.127898Z","level":"error","event":"downloading https://repo1.maven.org/maven2/org/apache/hadoop/hadoop-aws/3.3.4/hadoop-aws-3.3.4.jar ...","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-14T10:21:12.004514Z","level":"error","event":"\t[SUCCESSFUL ] org.apache.hadoop#hadoop-aws;3.3.4!hadoop-aws.jar (1685ms)","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-14T10:21:12.199873Z","level":"error","event":"downloading https://repo1.maven.org/maven2/com/amazonaws/aws-java-sdk-bundle/1.12.520/aws-java-sdk-bundle-1.12.520.jar ...","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-14T10:23:18.045025Z","level":"error","event":"\t[SUCCESSFUL ] com.amazonaws#aws-java-sdk-bundle;1.12.520!aws-java-sdk-bundle.jar (126037ms)","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-14T10:23:18.227947Z","level":"error","event":"downloading https://repo1.maven.org/maven2/org/apache/spark/spark-avro_2.12/3.5.0/spark-avro_2.12-3.5.0.jar ...","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-14T10:23:18.442858Z","level":"error","event":"\t[SUCCESSFUL ] org.apache.spark#spark-avro_2.12;3.5.0!spark-avro_2.12.jar (396ms)","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-14T10:23:18.640283Z","level":"error","event":"downloading https://repo1.maven.org/maven2/io/delta/delta-spark_2.12/3.1.0/delta-spark_2.12-3.1.0.jar ...","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-14T10:23:19.585194Z","level":"error","event":"\t[SUCCESSFUL ] io.delta#delta-spark_2.12;3.1.0!delta-spark_2.12.jar (1140ms)","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-14T10:23:19.780607Z","level":"error","event":"downloading https://repo1.maven.org/maven2/org/wildfly/openssl/wildfly-openssl/1.0.7.Final/wildfly-openssl-1.0.7.Final.jar ...","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-14T10:23:20.022392Z","level":"error","event":"\t[SUCCESSFUL ] org.wildfly.openssl#wildfly-openssl;1.0.7.Final!wildfly-openssl.jar (437ms)","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-14T10:23:20.208366Z","level":"error","event":"downloading https://repo1.maven.org/maven2/org/tukaani/xz/1.9/xz-1.9.jar ...","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-14T10:23:22.349290Z","level":"error","event":"\t[SUCCESSFUL ] org.tukaani#xz;1.9!xz.jar (2326ms)","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-14T10:23:22.549843Z","level":"error","event":"downloading https://repo1.maven.org/maven2/io/delta/delta-storage/3.1.0/delta-storage-3.1.0.jar ...","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-14T10:23:22.832802Z","level":"error","event":"\t[SUCCESSFUL ] io.delta#delta-storage;3.1.0!delta-storage.jar (480ms)","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-14T10:23:23.022625Z","level":"error","event":"downloading https://repo1.maven.org/maven2/org/antlr/antlr4-runtime/4.9.3/antlr4-runtime-4.9.3.jar ...","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-14T10:23:23.699945Z","level":"error","event":"\t[SUCCESSFUL ] org.antlr#antlr4-runtime;4.9.3!antlr4-runtime.jar (864ms)","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-14T10:23:23.701014Z","level":"error","event":":: resolution report :: resolve 17654ms :: artifacts dl 133384ms","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-14T10:23:23.701683Z","level":"error","event":"\t:: modules in use:","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-14T10:23:23.702623Z","level":"error","event":"\tcom.amazonaws#aws-java-sdk-bundle;1.12.520 from central in [default]","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-14T10:23:23.703592Z","level":"error","event":"\tio.delta#delta-spark_2.12;3.1.0 from central in [default]","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-14T10:23:23.704328Z","level":"error","event":"\tio.delta#delta-storage;3.1.0 from central in [default]","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-14T10:23:23.705211Z","level":"error","event":"\torg.antlr#antlr4-runtime;4.9.3 from central in [default]","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-14T10:23:23.706231Z","level":"error","event":"\torg.apache.hadoop#hadoop-aws;3.3.4 from central in [default]","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-14T10:23:23.707779Z","level":"error","event":"\torg.apache.spark#spark-avro_2.12;3.5.0 from central in [default]","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-14T10:23:23.708862Z","level":"error","event":"\torg.tukaani#xz;1.9 from central in [default]","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-14T10:23:23.709794Z","level":"error","event":"\torg.wildfly.openssl#wildfly-openssl;1.0.7.Final from central in [default]","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-14T10:23:23.711553Z","level":"error","event":"\t:: evicted modules:","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-14T10:23:23.712779Z","level":"error","event":"\tcom.amazonaws#aws-java-sdk-bundle;1.12.262 by [com.amazonaws#aws-java-sdk-bundle;1.12.520] in [default]","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-14T10:23:23.714331Z","level":"error","event":"\t---------------------------------------------------------------------","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-14T10:23:23.715444Z","level":"error","event":"\t|                  |            modules            ||   artifacts   |","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-14T10:23:23.716370Z","level":"error","event":"\t|       conf       | number| search|dwnlded|evicted|| number|dwnlded|","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-14T10:23:23.718783Z","level":"error","event":"\t---------------------------------------------------------------------","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-14T10:23:23.720481Z","level":"error","event":"\t|      default     |   9   |   8   |   8   |   1   ||   8   |   8   |","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-14T10:23:23.721597Z","level":"error","event":"\t---------------------------------------------------------------------","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-14T10:23:23.722847Z","level":"error","event":":: retrieving :: org.apache.spark#spark-submit-parent-575a89f9-c888-4a84-8daf-d68de1b9bbfd","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-14T10:23:23.723563Z","level":"error","event":"\tconfs: [default]","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-14T10:23:24.125169Z","level":"error","event":"\t8 artifacts copied, 0 already retrieved (337604kB/408ms)","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-14T10:23:24.397439Z","level":"error","event":"25/07/14 10:23:24 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-14T10:23:24.614562Z","level":"error","event":"Setting default log level to \"WARN\".","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-14T10:23:24.615311Z","level":"error","event":"To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-14T10:23:28.052025","level":"info","event":"Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.","logger":"chromadb.telemetry.product.posthog"}
{"timestamp":"2025-07-14T10:23:29.994802Z","level":"error","event":"25/07/14 10:23:29 WARN MetricsConfig: Cannot locate configuration: tried hadoop-metrics2-s3a-file-system.properties,hadoop-metrics2.properties","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-14T10:23:39.367278Z","level":"info","event":"root","chan":"stdout","logger":"task"}
{"timestamp":"2025-07-14T10:23:39.371943Z","level":"info","event":" |-- article_id: string (nullable = true)","chan":"stdout","logger":"task"}
{"timestamp":"2025-07-14T10:23:39.372825Z","level":"info","event":" |-- title: string (nullable = true)","chan":"stdout","logger":"task"}
{"timestamp":"2025-07-14T10:23:39.373402Z","level":"info","event":" |-- pub_date: date (nullable = true)","chan":"stdout","logger":"task"}
{"timestamp":"2025-07-14T10:23:39.373956Z","level":"info","event":" |-- summary: string (nullable = true)","chan":"stdout","logger":"task"}
{"timestamp":"2025-07-14T10:23:39.374425Z","level":"info","event":" |-- load_timestamp: timestamp_ntz (nullable = true)","chan":"stdout","logger":"task"}
{"timestamp":"2025-07-14T10:23:39.375219Z","level":"info","event":" |-- year_month: string (nullable = true)","chan":"stdout","logger":"task"}
{"timestamp":"2025-07-14T10:23:39.375806Z","level":"info","event":"","chan":"stdout","logger":"task"}
{"timestamp":"2025-07-14T10:23:40.235630Z","level":"error","event":"\r[Stage 0:>                                                          (0 + 2) / 2]\r\r                                                                                \r25/07/14 10:23:40 WARN SparkStringUtils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.sql.debug.maxToStringFields'.","chan":"stderr","logger":"task"}
{"timestamp":"2025-07-14T10:23:54.975214","level":"error","event":"Error processing Delta table: Expected IDs to be unique, found 54 duplicated IDs: cz9y1l397vno, cpvjdm4mp92o, c5y5zg85wnlo, cql6vgwyv4xo, cqx2jz1l477o, ..., tech-now-chiles-lost-children, cy4yv3pmmwjo, c62g6vdl3vqo, cy8kjdz9nr3o, cx2gy3j9xq6o in upsert.","logger":"unusual_prefix_0aab8e1abe4a8f324d874f9a30de87ad63865522_activefence"}
{"timestamp":"2025-07-14T10:23:54.975927","level":"error","event":"Task failed with exception","logger":"task","error_detail":[{"exc_type":"DuplicateIDError","exc_value":"Expected IDs to be unique, found 54 duplicated IDs: cz9y1l397vno, cpvjdm4mp92o, c5y5zg85wnlo, cql6vgwyv4xo, cqx2jz1l477o, ..., tech-now-chiles-lost-children, cy4yv3pmmwjo, c62g6vdl3vqo, cy8kjdz9nr3o, cx2gy3j9xq6o in upsert.","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":867,"name":"run"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1159,"name":"_execute_task"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/operator.py","lineno":397,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":216,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":239,"name":"execute_callable"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/callback_runner.py","lineno":81,"name":"run"},{"filename":"/opt/airflow/dags/activefence.py","lineno":312,"name":"embed_gold_data"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/chromadb/api/models/Collection.py","lineno":365,"name":"upsert"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/chromadb/api/models/CollectionCommon.py","lineno":95,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/chromadb/api/models/CollectionCommon.py","lineno":415,"name":"_validate_and_prepare_upsert_request"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/chromadb/api/types.py","lineno":312,"name":"validate_insert_record_set"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/chromadb/api/types.py","lineno":728,"name":"validate_ids"}],"is_group":false,"exceptions":[]}]}
{"timestamp":"2025-07-14T10:23:55.930701Z","level":"error","event":"\r[Stage 1:>                                                          (0 + 2) / 2]\r\r[Stage 3:>                                                         (0 + 2) / 50]\r\r[Stage 3:==>                                                       (2 + 2) / 50]\r\r[Stage 3:===>                                                      (3 + 2) / 50]\r\r[Stage 3:====>                                                     (4 + 2) / 50]\r\r[Stage 3:========>                                                 (7 + 2) / 50]\r\r[Stage 3:============>                                            (11 + 2) / 50]\r\r[Stage 3:===============>                                         (14 + 2) / 50]\r\r[Stage 3:====================>                                    (18 + 2) / 50]\r\r[Stage 3:=========================>                               (22 + 2) / 50]\r\r[Stage 3:=============================>                           (26 + 2) / 50]\r\r[Stage 3:==================================>                      (30 + 2) / 50]\r\r[Stage 3:======================================>                  (34 + 2) / 50]\r\r[Stage 3:==========================================>              (37 + 2) / 50]\r\r[Stage 3:==============================================>          (41 + 2) / 50]\r\r[Stage 3:===================================================>     (45 + 2) / 50]\r\r[Stage 3:======================================================>  (48 + 2) / 50]\r\r                                                                                \r\r[Stage 8:=============================>                           (26 + 2) / 50]\r\r[Stage 8:===================================================>     (45 + 2) / 50]\r\r                                                                                \r\r[Stage 9:>                                                          (0 + 2) / 2]","chan":"stderr","logger":"task"}
